cmake_minimum_required(VERSION 2.8)

# Define Project name
project(OrthancAccessRights)

# -> Orthanc Plugins CMake would be in the case the Plugin is not located in the Orthanc directory
# set(SAMPLES_ROOT ${CMAKE_SOURCE_DIR}/..)
# include(${SAMPLES_ROOT}/Common/OrthancPlugins.cmake)


# Orthanc root directory -> Location of source files
# This project must be located in the Orthanc Plugins directory by default
set(ORTHANC_ROOT ${CMAKE_SOURCE_DIR}/../../..)
set(ORTHANC_FRAMEWORK_PLUGIN ON)

# Include the Code of the Orthanc Project
include(${ORTHANC_ROOT}/Resources/CMake/OrthancFrameworkParameters.cmake)
include(${ORTHANC_ROOT}/Resources/CMake/OrthancFrameworkConfiguration.cmake)
include_directories(${ORTHANC_ROOT})

# Some definitions
add_definitions(
  -DORTHANC_ENABLE_LOGGING_PLUGIN=1
  -DHAS_ORTHANC_EXCEPTION=1
  )

# The embedded ressources which are added to the compiled library
# -> Some static files in the Ressources Directory
# -> Are included afterwards by EmbeddedRessources.h
EmbedResources(
  ORTHANC_EXPLORER ${CMAKE_SOURCE_DIR}/Resources/OrthancExplorer.js
  PRIVILEDGE_ADMINISTRATION ${CMAKE_SOURCE_DIR}/Resources/PriviledgeAdministration.html
  ${EMBEDDED_RESOURCES}
  )

// Add to the Library the Plugin.cpp file and the sources generated from the Orthanc core code
add_library(OrthancAccessRights SHARED 
  Plugin.cpp 
   ${ORTHANC_CORE_SOURCES}
   ${AUTOGENERATED_SOURCES}
)

// Name of the linked library
target_link_libraries(OrthancAccessRights)

// Install the Library to the Orthanc installtion directory
install(
  TARGETS OrthancAccessRights
  RUNTIME DESTINATION lib    # Destination for Windows
  LIBRARY DESTINATION share/orthanc/plugins    # Destination for Linux
  )













